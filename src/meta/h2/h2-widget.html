<link rel="import" href="./widgets/h2-widget-base.html">
<dom-module id="h2-widget">
    <template>
        <div id="slot"></div>
    </template>
    <script>
      class H2Widget extends H2WidgetBase {
        static get is() {
          return "h2-widget";
        }

        static get observers() {
          return [
            '__fieldMetaChange(fieldMeta)'
          ];
        }

        validate() {
          const ele = this.$.slot.firstChild;
          return ele && ele.validate && ele.validate();
        }

        reset() {
          const ele = this.$.slot.firstChild;
          return ele && ele.reset && ele.reset();
        }

        getValue() {
          const ele = this.$.slot.firstChild;
          return ele && ele.getValue && ele.getValue();
        }

        static get defaultElements() {
          return {
            'text': 'h2-text',
            'textarea': 'h2-text-area',
            'number': 'h2-number',
            'date': 'h2-date',
            'select-list': 'h2-select-list',
            'select-tree': 'h2-select-tree',
            'radio-group': 'h2-radio-group'
          };
        }

        __fieldMetaChange() {
          const tagName = this.fieldMeta.element || H2Widget.defaultElements[this.fieldMeta.datatype];
          const eleDom = document.createElement(tagName);
          eleDom.model = this.model;
          eleDom.fieldMeta = this.fieldMeta;
          this.$.slot.appendChild(eleDom);
        }
      }

      customElements.define(H2Widget.is, H2Widget);
    </script>
</dom-module>